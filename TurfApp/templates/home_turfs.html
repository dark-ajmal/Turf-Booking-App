{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OnlyTurf - Find Turfs</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00C853;
            --primary-dark: #009624;
            --secondary: #FF6D00;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --card-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark);
        }

        /* Header */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            font-size: 1.8rem;
            color: var(--primary);
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Page Header */
        .page-header {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('https://images.unsplash.com/photo-1543357483-0676-0c7310d5a2a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 3rem 0;
            margin-bottom: 2rem;
            text-align: center;
        }

        .page-header h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        /* Enhanced Filter Section */
        .filter-section {
            background: white;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .filter-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .filter-group {
            flex: 1;
        }

        .filter-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .filter-group select,
        .filter-group input,
        .filter-group .date-time-picker {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 200, 83, 0.1);
        }

        /* Date and Time Picker */
        .date-time-picker {
            display: flex;
            gap: 0.5rem;
        }

        .date-time-picker input {
            flex: 1;
        }

        /* Player Count Selector */
        .player-count {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .player-count button {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 1px solid #e0e0e0;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .player-count button:hover {
            background: #f0f0f0;
        }

        .player-count input {
            width: 50px;
            text-align: center;
        }

        /* Amenities Filter */
        .amenities-filter {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .amenity-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-outline {
            background: white;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn-outline:hover {
            background: rgba(0, 200, 83, 0.1);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 200, 83, 0.3);
        }

        /* Turf Grid */
        .turf-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .turf-card {
            background: white;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            transition: transform 0.3s;
            text-decoration: none;
            color: inherit;
        }

        .turf-card:hover {
            transform: translateY(-5px);
        }

        .turf-image {
            height: 200px;
            overflow: hidden;
            position: relative;
        }

        .turf-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .turf-card:hover .turf-image img {
            transform: scale(1.05);
        }

        .turf-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* Turf Card Content */
        .turf-content {
            padding: 1.5rem;
        }

        .turf-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .turf-title h3 {
            font-size: 1.3rem;
            margin-bottom: 0.3rem;
        }

        .turf-location {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--gray);
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
        }
        
        .turf-rating {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            color: #ffc107;
            margin-bottom: 0.8rem;
        }

        .turf-rating span {
            color: var(--dark);
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .turf-meta {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .turf-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .turf-meta-item i {
            color: var(--primary);
        }

        .turf-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .turf-price span {
            font-size: 1rem;
            color: var(--gray);
            font-weight: normal;
        }

        .turf-actions {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
        }
        
        .btn-sm {
            padding: 0.6rem 1rem;
            font-size: 0.9rem;
        }

        /* Sports Type Badges */
        .badge-football {
            background: rgba(0, 200, 83, 0.1);
            color: var(--primary);
        }

        .badge-cricket {
            background: rgba(30, 136, 229, 0.1);
            color: #1E88E5;
        }

        .badge-badminton {
            background: rgba(233, 30, 99, 0.1);
            color: #E91E63;
        }

        .badge-tennis {
            background: rgba(255, 160, 0, 0.1);
            color: #FFA000;
        }
        
        .no-image-placeholder {
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #f5f5f5;
            color: var(--gray);
            font-size: 2rem;
        }
        .no-image-placeholder i {
            margin-bottom: 0.5rem;
        }
        .no-turfs-message {
            grid-column: 1 / -1;
            text-align: center;
            padding: 2rem;
            color: var(--gray);
        }
        .no-turfs-message i {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 3rem;
        }

        .page-item {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
        }

        .page-item:hover {
            background: rgba(0, 200, 83, 0.1);
        }

        .page-item.active {
            background: var(--primary);
            color: white;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .turf-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .filter-row {
                flex-direction: column;
                gap: 1rem;
            }
            
            .turf-grid {
                grid-template-columns: 1fr;
            }
            
            .turf-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .amenities-filter {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
        }

        @media (max-width: 576px) {
            .page-header h2 {
                font-size: 2rem;
            }
            
            .date-time-picker {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <nav class="navbar">
                <div class="logo">
                    <i class="fas fa-futbol"></i>
                    <h1><span style="color:#009624 ; font-family: 'Poppins', sans-serif; font-weight: 700;">Only</span>Turf</h1>
                </div>
            </nav>
        </div>
    </header>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h2>Find Your Perfect Turf</h2>
            <p>Book top-quality sports facilities in your area</p>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container">
        <!-- Enhanced Filter Section -->
        <div class="filter-section">
            <div class="filter-row">
                <div class="filter-group">
                    <label for="sportType">Sport Type</label>
                    <select id="sportType">
                        <option value="">All Sports</option>
                        <option value="football">Football</option>
                        <option value="cricket">Cricket</option>
                        <option value="badminton">Badminton</option>
                        <option value="tennis">Tennis</option>
                        <option value="basketball">Basketball</option>
                        <option value="volleyball">Volleyball</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="location">Location</label>
                    <input type="text" id="location" placeholder="Enter location or city">
                </div>
            </div>
            
            <div class="filter-row">
                <div class="filter-group">
                    <label for="dateTime">Date & Time</label>
                    <div class="date-time-picker">
                        <input type="date" id="date" placeholder="Select date">
                        <select id="time">
                            <option value="">Any time</option>
                            <option value="morning">Morning (6AM-12PM)</option>
                            <option value="afternoon">Afternoon (12PM-5PM)</option>
                            <option value="evening">Evening (5PM-10PM)</option>
                        </select>
                    </div>
                </div>
                <div class="filter-group">
                    <label for="playerCount">Number of Players</label>
                    <div class="player-count">
                        <button type="button" id="decreasePlayers">-</button>
                        <input type="number" id="playerCount" min="1" max="30" value="5">
                        <button type="button" id="increasePlayers">+</button>
                    </div>
                </div>
            </div>
            
            <div class="filter-group">
                <label>Amenities</label>
                <div class="amenities-filter">
                    <div class="amenity-option">
                        <input type="checkbox" id="floodlights" name="amenities">
                        <label for="floodlights">Floodlights</label>
                    </div>
                    <div class="amenity-option">
                        <input type="checkbox" id="parking" name="amenities">
                        <label for="parking">Parking</label>
                    </div>
                    <div class="amenity-option">
                        <input type="checkbox" id="changingRooms" name="amenities">
                        <label for="changingRooms">Changing Rooms</label>
                    </div>
                    <div class="amenity-option">
                        <input type="checkbox" id="equipment" name="amenities">
                        <label for="equipment">Equipment Rental</label>
                    </div>
                </div>
            </div>
            
            <div class="filter-actions">
                <button class="btn btn-outline" id="resetFilters">
                    <i class="fas fa-filter"></i> Reset Filters
                </button>
                <button class="btn btn-primary" id="searchButton">
                    <i class="fas fa-search"></i> Find Turfs
                </button>
            </div>
        </div>

        <!-- Turf Grid -->
        <div class="turf-grid" id="turfResults">
            <!-- Dynamic turf cards will be rendered here -->
            {% for turf in turfs %}
            <a href="{% url 'booking_page' turf_id=turf.id %}" class="turf-card">
                <div class="turf-image">
                    {% if turf.image %}
                    <img src="{{ turf.image.url }}" alt="{{ turf.name }}">
                    {% else %}
                    <div class="no-image-placeholder">
                        <i class="fas fa-image"></i>
                        <span>No Image</span>
                    </div>
                    {% endif %}
                    <span class="turf-badge badge-{{ turf.sports_type }}">
                        {{ turf.sports_type|capfirst }}
                    </span>
                </div>
                <div class="turf-content">
                    <div class="turf-header">
                        <div class="turf-title">
                            <h3>{{ turf.name }}</h3>
                            <div class="turf-location">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>{{ turf.location }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="turf-rating">
                        <!-- Star rating hardcoded for now, would be dynamic from backend -->
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="far fa-star"></i>
                        <span>(128 reviews)</span>
                    </div>
                    <div class="turf-meta">
                        <div class="turf-meta-item">
                            <i class="fas fa-users"></i>
                            <span>{{ turf.no_of_players|default:'N/A' }} players</span>
                        </div>
                        <div class="turf-meta-item">
                            <i class="fas fa-rupee-sign"></i>
                            <span>₹{{ turf.price_per_hour|default:'0.00' }}/hour</span>
                        </div>
                        <div class="turf-meta-item">
                            <i class="fas fa-clock"></i>
                            <span>{{ turf.open_time|time:"h:i A"|default:'N/A' }} - {{ turf.close_time|time:"h:i A"|default:'N/A' }}</span>
                        </div>
                    </div>
                </div>
            </a>
            {% empty %}
                <div class="no-turfs-message">
                    <i class="fas fa-info-circle"></i>
                    <p>No turfs found matching your criteria. Try adjusting your filters.</p>
                </div>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        <div class="pagination">
            <div class="page-item">
                <i class="fas fa-chevron-left"></i>
            </div>
            <div class="page-item active">1</div>
            <div class="page-item">2</div>
            <div class="page-item">3</div>
            <div class="page-item">
                <i class="fas fa-chevron-right"></i>
            </div>
        </div>
    </div>

    <script>
        // DOM elements
        const turfResults = document.getElementById('turfResults');
        const searchButton = document.getElementById('searchButton');
        const resetFilters = document.getElementById('resetFilters');
        const increasePlayers = document.getElementById('increasePlayers');
        const decreasePlayers = document.getElementById('decreasePlayers');
        const playerCountInput = document.getElementById('playerCount');

        // Initial turf cards rendered by Django
        const initialTurfCards = Array.from(turfResults.querySelectorAll('.turf-card'));
        
        // Player count controls
        increasePlayers.addEventListener('click', () => {
            playerCountInput.value = parseInt(playerCountInput.value) + 1;
        });

        decreasePlayers.addEventListener('click', () => {
            playerCountInput.value = Math.max(1, parseInt(playerCountInput.value) - 1);
        });

        // Search functionality
        searchButton.addEventListener('click', () => {
            const sportType = document.getElementById('sportType').value;
            const location = document.getElementById('location').value.toLowerCase();
            const players = parseInt(playerCountInput.value);
            // In a real app, date/time/amenities filters would require server-side logic
            
            // Show loading state
            searchButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Searching...';
            
            // Simulate API call delay and filter rendered cards
            setTimeout(() => {
                let foundResults = false;
                initialTurfCards.forEach(card => {
                    const cardSport = card.querySelector('.turf-badge').textContent.toLowerCase();
                    const cardLocation = card.querySelector('.turf-location span').textContent.toLowerCase();
                    const cardPlayersText = card.querySelector('.turf-meta-item span').textContent;
                    const cardMinPlayers = parseInt(cardPlayersText.split('-')[0].trim());

                    const matchesSport = !sportType || cardSport.includes(sportType);
                    const matchesLocation = !location || cardLocation.includes(location);
                    const matchesPlayers = players <= cardMinPlayers; // Simplified logic

                    if (matchesSport && matchesLocation && matchesPlayers) {
                        card.style.display = 'block';
                        foundResults = true;
                    } else {
                        card.style.display = 'none';
                    }
                });
                
                // Show a message if no turfs are found
                if (!foundResults) {
                    turfResults.innerHTML = '<div class="no-turfs-message"><i class="fas fa-info-circle"></i><p>No turfs found matching your criteria. Try adjusting your filters.</p></div>';
                }
                
                searchButton.innerHTML = '<i class="fas fa-search"></i> Find Turfs';
            }, 800);
        });

        // Reset filters
        resetFilters.addEventListener('click', () => {
            document.getElementById('sportType').value = '';
            document.getElementById('location').value = '';
            document.getElementById('date').value = '';
            document.getElementById('time').value = '';
            playerCountInput.value = 5;
            document.querySelectorAll('input[name="amenities"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            initialTurfCards.forEach(card => card.style.display = 'block'); // Show all turfs
        });

        // Set default date to today
        document.getElementById('date').valueAsDate = new Date();
    </script>
</body>
</html>
